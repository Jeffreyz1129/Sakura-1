// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

model Audit {
    id        Int        @id @default(autoincrement())
    userId    BigInt
    event     AuditEvent
    metadata  Json
    timestamp DateTime   @default(now())

    @@unique([id])
    @@map("audit")
}

enum AuditEvent {
    CHECKED_CODE_ADD
    INVITE_CHECK_START
    INVITE_CHECK_FINISH
    SETTING_CREATE
    SETTING_DELETE
    SETTING_UPDATE
    UNCHECKED_CODE_ADD
    UNCHECKED_CODE_UPDATE
}

model Invite {
    guildId     BigInt
    code        String
    expiresAt   DateTime?
    isPermanent Boolean?
    isValid     Boolean?
    isChecked   Boolean   @default(false)
    createdAt   DateTime  @default(now())
    updatedAt   DateTime  @updatedAt

    @@unique([guildId, code])
    @@map("invite")
}

model Setting {
    guildId            BigInt    @id
    checkChannelId     BigInt?
    additionalRoleId   BigInt?
    categoryChannelIds BigInt[]
    ignoreChannelIds   BigInt[]
    checkEmbedColor    Int       @default(16316671)
    lastInviteCheckAt  DateTime?
    inCheck            Boolean   @default(false)
    createdAt          DateTime  @default(now())
    updatedAt          DateTime  @updatedAt

    @@unique([guildId])
    @@map("setting")
}
